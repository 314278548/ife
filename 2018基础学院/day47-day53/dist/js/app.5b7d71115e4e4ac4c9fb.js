!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=5)}([function(e,t,s){var i=s(3),r=s(4);e.exports=function(e,t,s){var u=t&&s||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var n=0;n<16;++n)t[u+n]=o[n];return t||r(o)}},function(e,t,s){},,function(e,t){var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var i=new Uint8Array(16);e.exports=function(){return s(i),i}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var s=[],i=0;i<256;++i)s[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=s;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},function(e,t,s){"use strict";s.r(t),s(1);var i=class{constructor({name:e,cost:t,price:s,time:i}){this.name=e,this.cost=t,this.price=s,this.time=i}setCustomer(e){this.customerId=e}},r=class{constructor(e,t){this.name=e,this.wage=t,this.status="free"}setId(e){this.id=e}setRestaurant(e){this.restaurant=e}finishWork(){}},u=class extends r{constructor(e,t){super(e,t),this.profession="Cook"}setDishesOk(e){this.restaurant.DishesOK.push(e)}},o=class extends r{constructor(e,t){super(e,t),this.profession="Waiter",this.Dishs=[]}orderDishes(e){this.Dishs=e.orderDishes(),this.status="orderDishes"}setDishes(){this.restaurant.addDishes(this.Dishs),this.Dishs=[],this.status="free"}sendDishes(e){(e=e.dishes).forEach(e=>{let t=e.customerId,s=this.restaurant.customerWaitQueue.findIndex(e=>e.id===t),i=this.restaurant.customerWaitQueue[s];s>0&&(i.eatDishes.push(e),i.eatDishes.length===i.Dishes.length&&(this.restaurant.customerEatQueue.push(i),this.restaurant.customerWaitQueue.splice(s,1)))})}},n=s(0),h=s.n(n),a=class{constructor(e,t){this.self=t,this.fn=e,this.successor=null}setNextSuccessor(e){return this.successor=e}passRequest(){let e=this.fn.apply(this.self,arguments);return"nextSuccessor"===e?this.successor&&this.successor.passRequest.apply(this.successor,arguments):e}next(){return this.successor&&this.successor.passRequest.apply(this.successor,arguments)}};class c{constructor({cash:e=0,seats:t=10,waiterQueue:s=[],cookQueue:i=[],customerQueue:r=[],menu:u=[]}){return this.staffId=100001,c.created?c.instance:(this.cash=e,this.seats=t,this.isRun=!1,this.waiterQueue=s,this.cookQueue=i,this.customerQueue=r,this.waiterWorkQueue=[],this.cookWorkQueue=[],this.customerEatQueue=[],this.customerWaitQueue=[],this.menu=u,this.Dishes=[],this.DishesOK=[],c.created=!0,c.instance=this,this.chainHead=new a(this.waiterToCust,this),this.chainHead.setNextSuccessor(new a(this.waiterToDishs,this)).setNextSuccessor(new a(this.cookToDishs,this)).setNextSuccessor(new a(this.cookToWaiter,this)).setNextSuccessor(new a(this.waiterSendCustDishs,this)).setNextSuccessor(new a(this.custToWaiter,this)),this)}setMenu(e){this.menu=e}addMenu(e){this.menu.push(e)}getMenu(){return this.menu}hire(e){e.setId(this.staffId++),e.setRestaurant(this),console.log("雇佣了",e),"Waiter"===e.profession?this.waiterQueue.push(e):"Cook"===e.profession&&this.cookQueue.push(e)}fire(e){let t;"Worker"===e.profession?t=this.waiterQueue:"Cook"===e.profession&&(t=this.cookQueue);let s=t.findIndex(t=>t.id===e.id);return t.splice(s,1)}customersComing(e){e.setRestaurant(this),this.customerQueue.push(e),this.run()}run(){this.isRun||(this.isRun=!0,this.chainHead.passRequest(),this.isRun=!1)}addDishes(e){let t=this.Dishes,s=t.find(t=>{t.name=e.name});s>=0?(t[s].dishes.push(e),t[s].time+=e.time):t.push({name:e.name,time:e.time,dishes:[e]})}waiterToCust(){if(console.log(this.waiterQueue.length>0&&this.customerQueue.length>0,this.waiterQueue,this.customerQueue),this.waiterQueue.length>0&&this.customerQueue.length>0){let e,t;for(console.log("服务员为顾客点菜");this.waiterQueue.length>0&&this.customerQueue.length>0;)e=this.waiterQueue.pop(),t=this.customerQueue.pop(),e.orderDishes(t),this.waiterWorkQueue.push(e),this.customerWaitQueue.push(t)}return"nextSuccessor"}waiterToDishs(){if(this.waiterWorkQueue.length>0){console.log("服务员把菜添加到点菜板");let e,t=this.waiterWorkQueue.length;for(;t>0&&"orderDishes"===this.waiterWorkQueue[t-1].status;)(e=this.waiterWorkQueue.pop()).setDishes(),this.waiterWorkQueue.length=--t}return"nextSuccessor"}waiterSendCustDishs(){if(this.waiterQueue.length>0&&this.DishesOK.length>0){let e,t;for(console.log("服务员送菜");this.waiterQueue.length>0&&this.customerQueue.length>0;)e=this.waiterQueue.pop(),t=this.DishesOK.pop(),e.sendDishes(t),this.waiterWorkQueue.push(e)}return"nextSuccessor"}cookToDishs(){if(this.cookQueue.length>0&&this.Dishes.length>0){let e,t;for(console.log("厨师从点菜版取菜单");this.cookQueue.length>0&&this.Dishes.length>0;)e=this.cookQueue.pop(),t=this.Dishes.pop(),e.setDishesOk(t),this.cookWorkQueue.push(e)}return"nextSuccessor"}cookToWaiter(){if(this.waiterQueue.length>0&&this.DishesOK.length>0){let e,t;for(console.log("做菜完成通知服务员");this.waiterQueue.length>0&&this.DishesOK.length>0;)e=this.waiterQueue.pop(),t=this.DishesOK.pop(),e.sendDishes(t),this.waiterQueue.push(e)}return"nextSuccessor"}custToWaiter(){if(console.log("顾客吃完服务员结账-未实现"),this.waiterQueue.length>0&&this.customerEatQueue.length>0){let e,t;for(;this.waiterQueue.length>0&&this.customerEatQueue.length>0;)e=this.waiterQueue.pop(),t=this.customerEatQueue.pop(),e.orderDishes(t),this.waiterWorkQueue.push(e),this.customerWaitQueue.push(t)}return"nextSuccessor"}}c.created=!1,c.instance=null;let l=new c({cash:1e4,seats:20,menu:[{name:"菜品1",cost:5,price:10,time:6},{name:"菜品2",cost:5,price:10,time:6},{name:"菜品3",cost:5,price:10,time:6},{name:"菜品4",cost:5,price:10,time:6},{name:"菜品5",cost:5,price:10,time:6}]}),p=new u("Cook",1e4);l.hire(p);let d=new o("Tony1",1e4);l.hire(d),p=new u("Cook2",1e4),l.hire(p),d=new o("Tony2",1e4),l.hire(d),p=new u("Cook3",1e4),l.hire(p),d=new o("Tony3",1e4),l.hire(d);let m=document.createDocumentFragment(),f=document.createElement("h1");f.innerText="一家餐厅-命令行版",m.appendChild(f);let Q=document.createElement("div");Q.id="canvas-box",m.appendChild(Q);let w=document.createElement("button");w.addEventListener("click",function(){let e=new class{constructor(){this.id=h()(),this.eatDishes=[],this.Dishes=[]}setRestaurant(e){this.restaurant=e}orderDishes(){let e,t,s=this.restaurant.getMenu(),r=s.length,u=Math.floor(Math.random()*r/2)+1,o=[];for(let n=0;n<u;n++)e=Math.floor(Math.random()*r),(t=new i(s[e])).setCustomer(this.id),o.push(t);return this.Dishes=o,o}eat(){}};l.customersComing(e)}),w.innerText="顾客到来",m.appendChild(w),document.body.appendChild(m)}]);
//# sourceMappingURL=app.5b7d71115e4e4ac4c9fb.js.map